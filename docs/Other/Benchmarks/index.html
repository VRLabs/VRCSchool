<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Other/Benchmarks" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.0">
<title data-rh="true">Unity/VRChat Performance Benchmarks | VRC School</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://vrc.school/img/embed.png"><meta data-rh="true" name="twitter:image" content="https://vrc.school/img/embed.png"><meta data-rh="true" property="og:url" content="https://vrc.school/docs/Other/Benchmarks"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="og:title" content="VRC School"><meta data-rh="true" name="og:type" content="website"><meta data-rh="true" name="og:url" content="https://vrc.school"><meta data-rh="true" name="og:description" content="Everything you need to know to make VRChat Avatar Systems"><meta data-rh="true" name="theme-color" content="#308BF2"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Unity/VRChat Performance Benchmarks | VRC School"><meta data-rh="true" name="description" content="Contributors: Jellejurre"><meta data-rh="true" property="og:description" content="Contributors: Jellejurre"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://vrc.school/docs/Other/Benchmarks"><link data-rh="true" rel="alternate" href="https://vrc.school/docs/Other/Benchmarks" hreflang="en"><link data-rh="true" rel="alternate" href="https://vrc.school/docs/Other/Benchmarks" hreflang="x-default"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.10929556.css">
<script src="/assets/js/runtime~main.7deca22e.js" defer="defer"></script>
<script src="/assets/js/main.da5e800f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/favicon.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/favicon.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">VRC School</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Unity-Animations/Intro-Unity-Animation">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/VRLabs/VRCSchool" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Unity-Animations/Intro-Unity-Animation">Unity Animations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/Avatars/Intro-VRChat-Avatars">Avatars</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/Other/Benchmarks">Other</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Other/Benchmarks">Unity/VRChat Performance Benchmarks</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Other/Network-Sync">Network Sync</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Other/Parameter-Mismatching">Expression Parameter Mismatching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Other/DBT-Combining">Combining Layers Using Direct Blend Trees</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Other/Advanced-BlendTrees">Advanced Blend Tree Techniques</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Other/AAPs">Animated Animator Parameters (AAP)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Other/Scale-Friendly">Designing Scale-Friendly Systems</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Other/Stations">Stations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Other/Sub-Animator">Sub-Animator Techniques</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Other</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Unity/VRChat Performance Benchmarks</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p>Contributors: <a href="https://jellejurre.dev/" target="_blank" rel="noopener noreferrer">Jellejurre</a></p>
<h1>Introduction</h1>
<p>This is a writeup on the performance (mostly focused on frame time) of components in Unity and VRChat.</p>
<p>The general methodology used to generate this data is to not look at the performance of a single instance of a Component, but to add more and more components and extract the formula for the performance from this data. For example: If we want to know how much frame time it costs to have one extra layer on an FX controller, we can have 1, 8, 64 and 256 layers, plot those on a graph, fit a line to this data, and use the formula of this line to see how much frame time it costs to add a single extra layer.</p>
<p>My goal is to test the performance of every single component that can be used in VRChat to give a rough estimate of how heavy they are to run compared to each other, to help the community choose more optimized methods to do things.</p>
<p>Throughout this article, I will give the results in ms of frame time. To interpret this, it is good to think about it like this:</p>
<p>If your goal is to have 90 fps, you have approximately 11 ms (so 0.011 seconds) to render each frame. This is your budget. Some of this time will be spent on PhysBones, some of it will be spent on Animators, some of it will be spent on Materials, etc. So if something takes 1 ms, you can see this as taking about 9.1% of your “budget”.</p>
<p>Do note that this frame time is used for processing every single avatar and the world, so if something on a single avatar takes 9.1% of the total budget, that is quite a lot, and should probably be a point of optimization.</p>
<p><strong>To have 60 fps, your frame time budget is approximately 16 ms.
To have 40 fps, your frame time budget is 25 ms.</strong></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The graphs used in this document are generated on a computer with the following specs</p><p>CPU: AMD Ryzen 7 5800X
Memory: DDR4 2x16GB 3200 MHz CL18
GPU: NVIDIA GeForce RTX 4090</p><p>The data used throughout this document is generated using <a href="https://github.com/jellejurre/UnityBenchmark" target="_blank" rel="noopener noreferrer">https://github.com/jellejurre/UnityBenchmark</a></p></div></div>
<p>Special thanks to Cibbi for contributing his data and helping me generate the controllers</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="53522b80ca174b369736ba6ef73f63dd">Animator Controllers<a href="#53522b80ca174b369736ba6ef73f63dd" class="hash-link" aria-label="Direct link to Animator Controllers" title="Direct link to Animator Controllers">​</a></h2>
<p>To put the numbers in this section into perspective, I’d like to mention two points:</p>
<ul>
<li>Every test here is done without any state behaviours. Having one or more state behaviours on any layer of any controller increases the runtime of all controllers on that avatar by 50%. This happens regardless which state behaviour you are using, and since there are state behaviours on the default Action &amp; Gesture layer, this cost is probably incurred on every single avatar that gets used. Because this cost is always there, I have chosen not to include it in any of my testing, since my tests are supposed to be comparative, but do note that if you’re looking at any of the raw numbers, you should probably add a 50% cost on top of it to get the actual numbers.</li>
<li>Animator controllers don’t scale linearly. I will touch on this later, but having two avatars with 100 layers is not as laggy as having a single avatar with 200 layers. It is useful to optimize controllers, since less frametime is still a win, but if you get weird numbers (like the fact that if it scaled linearly, having 40 avatars with 50 layers would take 68 ms, but in reality it takes 6.4 ms)</li>
</ul>
<p>I will first go over single controller frame time performance, and then I will go over how this scales with having multiple controllers.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="8b4448b945d245e5ae1309030289212a">Single Controller Performance<a href="#8b4448b945d245e5ae1309030289212a" class="hash-link" aria-label="Direct link to Single Controller Performance" title="Direct link to Single Controller Performance">​</a></h3>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="baseline-two-state-toggle">Baseline: Two state toggle<a href="#baseline-two-state-toggle" class="hash-link" aria-label="Direct link to Baseline: Two state toggle" title="Direct link to Baseline: Two state toggle">​</a></h4><p>For our baseline, we are going to look at the simple 2 state toggle.</p></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="The default toggle we will be comparing against. Two animations, each with two frames, both with the same value. Write defaults on." src="/assets/images/Benchmarks.4351b050-8e08-4da8-bd75-b72a22e8ded4-0a6114e2cfee1c371880905e267ea659.png" width="898" height="247" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">The default toggle we will be comparing against. Two animations, each with two frames, both with the same value. Write defaults on.</p><p></p></div><div class="notion-spacer"></div></div>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p>In every layer count test, the graph for layers vs frame time is quadratic. this means that the more layers you have, the worse adding an extra layer becomes. However, the quadratic term isn’t very strong, so for low layer counts, it can be approximated by a linear graph. For the basic toggle, this will be 0.01 ms per layer. This is our baseline to compare against.</p><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>The results shown in this graph are in the <code>static</code> case, meaning no parameters were actively being changed.</p></div></div></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="The frame time to layer count graph for the basic toggle without being actively toggled." src="/assets/images/Benchmarks.98dec25c-ed4d-4580-8f10-112ad6d3616f-255e5d182ee410a15cd5724d4d2234f1.png" width="640" height="480" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">The frame time to layer count graph for the basic toggle without being actively toggled.</p><p></p></div><div class="notion-spacer"></div></div>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p>If we run this same benchmark again, but while actively animating the layers, we get the following graph.</p><p>This graph shows us that there is an approximately 20-30% higher cost for toggles that are constantly toggled, compared to ones that aren’t. This would be the case for face/eye tracking for example. This 20-30% higher cost seems to be consistent with all my setups (AnyState, AnyState self transition, multiple animators, etc.), except for direct Blend Trees, where it depends on the setup.</p></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="The frame time to layer count graph for the basic toggle while being actively toggled." src="/assets/images/Benchmarks.7282930c-45a3-44c9-8bc6-dfc8238903b2-15998831b1f6d0cc656b501a161feede.png" width="640" height="480" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">The frame time to layer count graph for the basic toggle while being actively toggled.</p><p></p></div><div class="notion-spacer"></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="anystate">AnyState<a href="#anystate" class="hash-link" aria-label="Direct link to AnyState" title="Direct link to AnyState">​</a></h4>
<p>AnyState seems to be similar in performance to non-AnyState toggles, no matter the amount of AnyState toggles. This indicates the amount of transitions checks is not a significant contributing factor to frame time, which is confirmed by other tests.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>The only notable exception here is an AnyState toggle with “Can Transition to Self” active, as this does incur a <strong>20% penalty over non-can-transition-to-self</strong>, even with the constant toggling comparison.</p></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="direct-blend-trees">Direct Blend Trees<a href="#direct-blend-trees" class="hash-link" aria-label="Direct link to Direct Blend Trees" title="Direct link to Direct Blend Trees">​</a></h4>
<p>When the surprisingly large cost of layers was first discovered, people called for Direct Blend Trees as the one magical solution that would cut frame time by orders of magnitude. My results indicate that, while they don’t take zero time, they are an excellent tool in reducing frame time.</p>
<p>I have found two setups which are more performant than the normal layer toggles, one easier to work with, but slightly slower, and the other more difficult to set up, but slightly more performant.</p>
<p>For the slower setup I used a single Direct Blend Tree, with many 1D Blend Trees as children. All the children consistently had weight one, but the 1D Blend Tree blend value would be controlled for the toggles.</p>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Direct Blend Tree frame time without the constant toggling" src="/assets/images/Benchmarks.f3ff7277-627c-481c-a23c-878bf8557ce2-47d20642915a324d984e71e270846601.png" width="640" height="480" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Direct Blend Tree frame time without the constant toggling</p><p></p></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Direct Blend Tree frame time with the constant toggling" src="/assets/images/Benchmarks.cedfddde-bb1a-4c01-8c31-e2ed8446ef8d-561641ec45acf4495d1397c73354e291.png" width="640" height="480" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Direct Blend Tree frame time with the constant toggling</p><p></p></div><div class="notion-spacer"></div></div>
<p>From these results we can see that this cut our frame time by approximately 3/4ths, which is very good. Especially with large amounts of toggles, this can help a lot with performance.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>To find out how to make one of these Blend Trees, I recommend reading <a href="/docs/Other/DBT-Combining">Combining Layers Using Direct Blend Trees</a>.</p></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Some people use the techniques described in <a href="/docs/Other/Advanced-BlendTrees">Advanced Blend Tree Techniques</a> to use blend trees for dissolves. Exponential smoothing is 2x faster than a normal toggle, but is FPS dependent. Linear smoothing with frameTime detection is FPS independent, but 2x as slow as a normal toggle. So try to use Exponential smoothing for dissolve toggles, and if you can’t, use a layer.</p></div></div>
<p>For the slightly faster setup, there are two layers required. The first layer is a single animation which animates the defaults of all the toggles. The second layer is a single Direct Blend Tree which uses the toggle parameters to toggle the state of the toggles with one animation per toggle.
So say for example I have a pair of shoes to toggle, and I want them on by default, then on the first layer in the big animation I’d animate the <code>IsActive</code> value to true, and on the second layer in the big Direct Blend Tree, I’d put an animation which animates the <code>IsActive</code> value to false, with the blend parameter being the parameter that I want to use. So when the parameter is 0, the animation weight is 0 and the default layer takes over, and when the parameter is 1 the animation is 1 and it overwrites the default layer.</p>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Direct Blend Tree frame time with default animation layer without constant toggling" src="/assets/images/Benchmarks.2a117ac0-6a72-4ad8-b8a6-340aa3d81907-83944eeac8684c5575627336b206e1b8.png" width="640" height="480" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Direct Blend Tree frame time with default animation layer without constant toggling</p><p></p></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Direct Blend Tree frame time with default animation layer with constant toggling" src="/assets/images/Benchmarks.e1ac14d9-30d1-4298-8beb-196d50e6cc99-b1a7956d94e8b931c508ea22acb64080.png" width="613" height="471" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Direct Blend Tree frame time with default animation layer with constant toggling</p><p></p></div><div class="notion-spacer"></div></div>
<p>From these results we can see that we cut or frame time by approximately 4/5ths over the simple two state toggles, and by 50% over the 1D Blend Tree setup in the active case, which is quite a big improvement, but how it works might be less clear and it can be more work to set up.</p>
<p>If you are constantly switching toggles (for example you’re building some face tracking setup or you’re using the voice parameter a lot), it might be an idea to use this, but otherwise, personally I’d stick with the two state setup.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="miscellaneous">Miscellaneous<a href="#miscellaneous" class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous">​</a></h4>
<p>Now for some miscellaneous data which doesn’t directly relate to toggles, but might be useful to someone:</p>
<ul>
<li>
<p>State count per layer and transition count don’t seem to matter much (which might be why AnyState is so cheap)</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>The only time where this isn’t true is if there are many bool transitions out from a single state (many here meaning 1000 for 1 ms). Float/Int seems to not have this added overhead</p></div></div>
</li>
<li>
<p>Using empty layers on humanoid rigs, using non-humanoid rigs and using no avatar all seem to cut frame time per layer by about 50% compared to the two state setup</p>
</li>
<li>
<p>Masking seems to have little to no effect on frame time</p>
</li>
<li>
<p>Using sub-state machines seems to have little to no effect on frame time</p>
</li>
<li>
<p>Nesting blendtrees for clarity seems to have little to no effect on frame time</p>
</li>
<li>
<p>For Direct Blend Trees, WD off seems to not change frame times by much</p>
</li>
<li>
<p>For layer toggles, WD off seems to increase frame time by around 50%</p>
</li>
<li>
<p>Parameters on the local avatar seem to cost 1.5 ms per 1000, but this cost doesn’t apply to remote avatars</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="5b4def9bfebe4193b32c5a6559771a79">Multiple Controller Performance<a href="#5b4def9bfebe4193b32c5a6559771a79" class="hash-link" aria-label="Direct link to Multiple Controller Performance" title="Direct link to Multiple Controller Performance">​</a></h3>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Having multiple controllers does NOT scale linearly (that is, having 2 controllers with 100 layers causes way less lag than 1 controller with 200 layers).</p></div></div><p>The actual relationship is hard to describe, but here is a visual to maybe help with this. Where every line is a constant frame time. So for example 5 controllers with 580 layers are as laggy as 15 controllers with 300 layers.</p><p>I see two main takeaways from this graph:</p><ul>
<li>Big controllers cause a lot of frame time compared to many small ones. Optimization is especially necessary if you have many layers. (1 100 layer controller takes as much frame time as 10 30 layer controllers).</li>
<li>Even with many controllers, if you halve the layer count on all of them, your total frame time still goes down by 50%. So if everyone optimized their layer count/layer setup, this would increase performance for everyone.</li>
</ul><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>This relation seems the same for all controller types/layer configurations.</p></div></div></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Frame time for controllers vs layers per controller with WD on two toggle states without active toggling." src="/assets/images/Benchmarks.3982e6fd-bd72-42c7-b939-c57eab15bbe0-46857a95e144335a6fb6c64f36a4862d.png" width="640" height="480" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Frame time for controllers vs layers per controller with WD on two toggle states without active toggling.</p><p></p></div><div class="notion-spacer"></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="eae81b01bded43f984ceccf46942a730">Face Tracking<a href="#eae81b01bded43f984ceccf46942a730" class="hash-link" aria-label="Direct link to Face Tracking" title="Direct link to Face Tracking">​</a></h3>
<p>Since face tracking takes up many layers, I wanted to do a comparison between a normal VRCFT controller, and a FX controller generated by Razgriz’s <a href="https://github.com/rrazgriz/VRCFTGenerator" target="_blank" rel="noopener noreferrer">VRCFTGenerator</a> (which packs the layers into Blend Trees).</p>
<p>I won’t bore you with the graphs, since they are just a straight line, but as for the data (this is with 37 face tracking parameters):</p>
<ul>
<li>VRCFT: 0.1733 ms per controller</li>
<li>VRCFTGenerator: 0.066 ms per controller, a 62% decrease over the non Blend Tree version.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="caec003575e446d2bf97a8a23de7daf8">Constraints<a href="#caec003575e446d2bf97a8a23de7daf8" class="hash-link" aria-label="Direct link to Constraints" title="Direct link to Constraints">​</a></h2>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>VRChat is adding a new component, VRCConstraint, that will replace constraints in VRChat. The section on them is below this one.</p></div></div>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p>After animator controllers, I’m very happy to talk about something simple. Constraints behave weirdly, but in a very predictable way.</p><p>Take the total amount of enabled constraints (type doesn’t matter) and use this graph to get the frame time. You can see that there are slow inclines, until a big jump. When VRChat was choosing their limits for constraints, they chose 681 to make sure you don’t have to take the penalty for that big jump, and I think that makes a lot of sense, since it goes from 1.7 ms to 2.4 ms (above the 0 point, which is 2 ms in this graph).</p><p>The jump alone there would take up 6% of your total frame budget for 90 fps, and that is without the performance cost of the constraints factored in.</p><p>An approximation for their performance would be 2-4 ms per 1000 constraints, but that is assuming you don’t go over 1250 constraints total enabled at the same time, since it goes up fast after that.</p><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Disabled constraints do not count towards this total graph. Disabled here means either:</p><ul>
<li>GameObject is disabled</li>
<li>Constraint component is disabled</li>
<li>Constraint is set to “disabled”</li>
</ul><p>However, setting the weight to 0 still makes it count for performance!</p></div></div></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Frame time of constraints" src="/assets/images/Benchmarks.4114091d-819b-454e-aef3-085c592f10d7-10228989624d158da2d465af473aea41.png" width="640" height="480" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Frame time of constraints</p><p></p></div><div class="notion-spacer"></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="59ace515859342c0b58324f69473f172">VRC Constraints<a href="#59ace515859342c0b58324f69473f172" class="hash-link" aria-label="Direct link to VRC Constraints" title="Direct link to VRC Constraints">​</a></h2>
<p>VRC Constraints are components added by VRChat that will replace Unity Constraints in VRChat. They are meant to be more optimized and more feature complete versions of Unity Constraints, while still being a drop-in replacement. There is an auto conversion feature at the bottom of the VRCSDK.</p>
<p>Their frame time is a lot worse in the unity editor than in game, which is why I sadly don’t have any graphs, but I do have valuable data:</p>
<ul>
<li>VRC Constraints cost about 0.25 ms of frame time per 1000 active VRC Constraints, no matter how many sources there are.<!-- -->
<ul>
<li>Note that this number is at a depth of 1. At a depth of 20, it would be about 0.27 ms, and at a depth of 100 it would be 0.5 ms. Most people won’t have issues with depth getting this high, but be mindful that high depth can slow things down.</li>
</ul>
</li>
<li>Unity Constraints that are auto converted to VRC Constraints in game cost about 0.75 ms per 1000 active Constraints. This means they are still better than Unity Constraints without conversion, but converting to VRC Constraints in editor is worth it for the frame time improvement.</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="0aa8f1f5ef8741579fb8e92b44fe3163">Audio Sources<a href="#0aa8f1f5ef8741579fb8e92b44fe3163" class="hash-link" aria-label="Direct link to Audio Sources" title="Direct link to Audio Sources">​</a></h2>
<p>Try as I might, I can’t seem to make these have any performance impact at all, even in unity where the max is 64 compared to VRChat’s 3 per avatar.</p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="f1c3c67f6e384fb7b8a853fdcc29f95a">Contact Senders/Receivers<a href="#f1c3c67f6e384fb7b8a853fdcc29f95a" class="hash-link" aria-label="Direct link to Contact Senders/Receivers" title="Direct link to Contact Senders/Receivers">​</a></h2>
<p>The first thing I want to say is that contacts have a max limit of 4096 per instance. If you have more than 4096 contacts in one instance, some will stop working</p>
<p>Contact senders and receivers are pretty straightforward as well, costing:</p>
<ul>
<li>0.5 ms of frame time for every 1000 senders/receivers while they aren’t actively being toggled</li>
<li>0.75 ms of frame time for every 1000 receivers while they are actively being toggled</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>These values seem to be roughly the same no matter the shape, type, parameter count, and collision tags</p></div></div>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Do note that this isn’t factoring in the time of parameters on your local avatar. Parameters on the local avatar have an extra cost of 1.5 ms per 1000 parameters</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="fbcfa24e24804883b2ef8d7fb7288e21">Cloth<a href="#fbcfa24e24804883b2ef8d7fb7288e21" class="hash-link" aria-label="Direct link to Cloth" title="Direct link to Cloth">​</a></h2>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5625)"><p>Cloth components are very heavy and should be used very sparingly.</p><p>For any reasonable amount of vertices (up to ~200k vertices), a cloth component will add around 0.2 ms per 1000 vertices. Above this, the frame time shoots up hard before tapering off, but this is only with unreasonable amounts of vertices.</p><p>Note that this 200k vertices limit is for the entire lobby. The amount of cloth components does not seem to matter for the lag, just the amount of cloth vertices.</p><div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Note that due to mirror and shadow clones, the local avatar’s cloth is simulated three times, and therefore its vertices should be counted thrice</p></div></div><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Colliders will make a cloth component take about twice as much frame time per 10 colliders. So per collider, it will take about 7% more frame time.</p></div></div></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.4375)"><p><img decoding="async" loading="lazy" alt="Frame time of cloth with changing vertex count" src="/assets/images/Benchmarks.44f45e0a-c4f6-434f-9dd4-ef2cd406ca82-62b7201d1b700e6622d2890e1091b017.png" width="667" height="516" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Frame time of cloth with changing vertex count</p><p></p></div><div class="notion-spacer"></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="adb92e7129ff428a8c3b0fc2ae45714f">PhysBones<a href="#adb92e7129ff428a8c3b0fc2ae45714f" class="hash-link" aria-label="Direct link to PhysBones" title="Direct link to PhysBones">​</a></h2>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p>Physbones are quite well optimized, and within reason can be considered pretty cheap. It seems that the frame time of PhysBones is mostly reliant on how many transforms they animate, at a rate of 0.66 ms per 1000 affected PhysBone transforms.</p><p>The component hierarchy shape (what is parented to what) and amount of components seem to have a slight effect on this, giving me a 33% difference between extremes, where fewer components is better.</p><p>Collider count has a very slight impact on frame time, and the other settings seem to have no noticeable effect.</p><div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>Since PhysBones’ runtime is very different in VRChat and Unity, these results are gotten from tests within VRChat. While usually the results are verified in VRChat, this time all the data is from VRChat, and therefore the results may be less accurate.</p></div></div></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Frame time of Phys Bone Transforms" src="/assets/images/Benchmarks.c60fe5b4-e953-4656-a53c-0bf39fdcb335-22389c736b2743045551835ca6dd367c.png" width="584" height="471" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Frame time of Phys Bone Transforms</p><p></p></div><div class="notion-spacer"></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3a6a07f5614048f1b60ce344e0f9cef3">Skinned Mesh Renderers<a href="#3a6a07f5614048f1b60ce344e0f9cef3" class="hash-link" aria-label="Direct link to Skinned Mesh Renderers" title="Direct link to Skinned Mesh Renderers">​</a></h2>
<p>Skinned Mesh Renderers are quite the important topic for optimization, as material count and vertex count can be one of the most difficult things to optimize on an avatar. They are mostly reliant on the GPU, so it is important to mention that these results have been obtained on a RTX 4090, however the general trends have been verified on a RTX 3080 and a GTX 1080Ti.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>These benchmarks only look at frame time, not VRAM, which is another performance metric heavily affected by meshes and their properties (especially blendshapes).</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="d329f332f05b4555a329efb5bb56abb4">Materials<a href="#d329f332f05b4555a329efb5bb56abb4" class="hash-link" aria-label="Direct link to Materials" title="Direct link to Materials">​</a></h3>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p>A “Draw Call” is when your CPU tells your GPU to render a mesh. Every material gets seen as a separate mesh and therefore gets its own draw call. 1 mesh with 3 materials is 3 draw calls, and 3 meshes with 1 material is also 3 draw calls.</p><p>It is generally understood that more draw calls = more frame time, and my benchmarks seem to support this.</p><p>So, 100 skinned mesh renderers using 1 material have about equal frame time as 1 skinned mesh renderer with 100 materials.</p><p>As for concrete time numbers: 1000 draw calls seem to take about 2 ms.</p></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Frame times of Material Count vs Mesh Count. Note that the graph is quite symmetrical across the red line, meaning that 40 meshes with 60 materials has nearly the same frame time as 60 meshes with 40 materials." src="/assets/images/Benchmarks.d1467fa6-76a7-4554-939a-c117fe331047-c29f21732e919af9e3d6731eb6729d2e.png" width="581" height="482" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Frame times of Material Count vs Mesh Count. Note that the graph is quite symmetrical across the red line, meaning that 40 meshes with 60 materials has nearly the same frame time as 60 meshes with 40 materials.</p><p></p></div><div class="notion-spacer"></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a0609ab86fd144bbadeb4f57ca31e019">Bones<a href="#a0609ab86fd144bbadeb4f57ca31e019" class="hash-link" aria-label="Direct link to Bones" title="Direct link to Bones">​</a></h3>
<div class="notion-row"><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p>Adding more bones to a skinned mesh renderer showed they seem to take about 0.32 ms per 1000 bones (while moving, however all bones move almost all the time). Do note that if you use PhysBones to move that many bones, the PhysBones would cost another 0.66 ms per 1000 bones.</p><div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Vertex count did not seem to matter much for Bone or Material tests, but the Standard shader was used for all of these, so it might matter more for more intensive shaders that do heavy per-vertex calculations.</p></div></div></div><div class="notion-spacer"></div><div class="notion-column" style="width:calc((100% - (min(32px, 4vw) * 1)) * 0.5)"><p><img decoding="async" loading="lazy" alt="Frame time of bones on a Skinned Mesh Renderer" src="/assets/images/Benchmarks.d154c876-8ee5-4ee9-91db-41bdd74bb938-c4d6e788c64fb9714e8e37f047d08296.png" width="584" height="471" class="img_ev3q"><br></p><p style="color:grey;font-style:italic">Frame time of bones on a Skinned Mesh Renderer</p><p></p></div><div class="notion-spacer"></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a2d0ed738bac4f348a092e6c96b822a3">Blendshapes<a href="#a2d0ed738bac4f348a092e6c96b822a3" class="hash-link" aria-label="Direct link to Blendshapes" title="Direct link to Blendshapes">​</a></h3>
<p>Blendshapes are the one test where vertex count mattered, but not by a lot. Blendshapes seem to take 0.005 ms per million vertices per blendshape, if all blendshapes are actively being changed.</p>
<p>Some interesting information:</p>
<ul>
<li>For frame time, It doesn’t seem to matter if only one vertex, or all vertices are being changed by a blendshape</li>
<li>For frame time, Inactive blendshapes seem practically free</li>
</ul>
<div class="theme-admonition theme-admonition-danger admonition_xJq3 alert alert--danger"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_BuS1"><p>Blendshapes still have a VRAM cost, even when not changed, so they should still be eliminated where-ever possible.</p></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="d672e86efd5f43b99773069fd9478757">Other components?<a href="#d672e86efd5f43b99773069fd9478757" class="hash-link" aria-label="Direct link to Other components?" title="Direct link to Other components?">​</a></h2>
<p>I am planning to continue benchmarking components after this. Some components I have already started on, but I’m not sure enough yet about my data to post it.</p>
<p>The components I want to benchmark in the future are:</p>
<ul>
<li>Particle Systems</li>
<li>Lights</li>
<li>Animations (whether value / reference matters, whether the amount of animated properties matters)</li>
</ul>
<p>Once I’ve got to them, I’ll add them to this document</p>
<p>If you have other things you want me to benchmark or you think I made a mistake, feel free to let me know on discord at @jellejurre#8585</p>
<hr>
<div style="text-align:right">Last Updated: 15 November 2024 14:35:00</div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/VRLabs/VRCSchool/tree/main/docs/Other/Benchmarks.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Avatars/Troubleshooting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Troubleshooting 3.0</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Other/Network-Sync"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Network Sync</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#53522b80ca174b369736ba6ef73f63dd" class="table-of-contents__link toc-highlight">Animator Controllers</a><ul><li><a href="#8b4448b945d245e5ae1309030289212a" class="table-of-contents__link toc-highlight">Single Controller Performance</a><ul><li><a href="#baseline-two-state-toggle" class="table-of-contents__link toc-highlight">Baseline: Two state toggle</a></li><li><a href="#anystate" class="table-of-contents__link toc-highlight">AnyState</a></li><li><a href="#direct-blend-trees" class="table-of-contents__link toc-highlight">Direct Blend Trees</a></li><li><a href="#miscellaneous" class="table-of-contents__link toc-highlight">Miscellaneous</a></li></ul></li><li><a href="#5b4def9bfebe4193b32c5a6559771a79" class="table-of-contents__link toc-highlight">Multiple Controller Performance</a></li><li><a href="#eae81b01bded43f984ceccf46942a730" class="table-of-contents__link toc-highlight">Face Tracking</a></li></ul></li><li><a href="#caec003575e446d2bf97a8a23de7daf8" class="table-of-contents__link toc-highlight">Constraints</a></li><li><a href="#59ace515859342c0b58324f69473f172" class="table-of-contents__link toc-highlight">VRC Constraints</a></li><li><a href="#0aa8f1f5ef8741579fb8e92b44fe3163" class="table-of-contents__link toc-highlight">Audio Sources</a></li><li><a href="#f1c3c67f6e384fb7b8a853fdcc29f95a" class="table-of-contents__link toc-highlight">Contact Senders/Receivers</a></li><li><a href="#fbcfa24e24804883b2ef8d7fb7288e21" class="table-of-contents__link toc-highlight">Cloth</a></li><li><a href="#adb92e7129ff428a8c3b0fc2ae45714f" class="table-of-contents__link toc-highlight">PhysBones</a></li><li><a href="#3a6a07f5614048f1b60ce344e0f9cef3" class="table-of-contents__link toc-highlight">Skinned Mesh Renderers</a><ul><li><a href="#d329f332f05b4555a329efb5bb56abb4" class="table-of-contents__link toc-highlight">Materials</a></li><li><a href="#a0609ab86fd144bbadeb4f57ca31e019" class="table-of-contents__link toc-highlight">Bones</a></li><li><a href="#a2d0ed738bac4f348a092e6c96b822a3" class="table-of-contents__link toc-highlight">Blendshapes</a></li></ul></li><li><a href="#d672e86efd5f43b99773069fd9478757" class="table-of-contents__link toc-highlight">Other components?</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">VRLabs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://vrlabs.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.vrlabs.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/VRLabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/vrlabsdev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">JustSleightly</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://links.sleightly.dev/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Links<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.sleightly.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://store.sleightly.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Store<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.sleightly.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/VRLabs/VRCSchool" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 VRLabs, Inc  & JustSleightly. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>